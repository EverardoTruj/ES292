library(githubr)
library(rethinking)
sample<-c(L,L,L,W,W,W,W,W,W,W)
sample<-c("L","L","L","W","W","W","W","W","W","W")
w<-sum(sample=="W")
l<-sum(sample=="L")
w<-sum(sample=="W")
l<-sum(sample=="L")
p<-0.3
ways<-sapply(p,fuction(q) (2*q)^L*((1-q)*2)W)
ays<-sapply(p,fuction(q) (2*q)^L*((1-q)*2)^W)
ways<-sapply(p,fuction(q)=(2*q)^L*((1-q)*2)^W)
ways<-sapply(p,fuction(q)(2*q)^L*((1-q)*2)^W)
ways<-sapply(list, function)(p,fuction(q)(2*q)^L*((1-q)*2)^W)
ways<-sapply(list, function)(p, fuction(q)(2*q)^L*((1-q)*2)^W)
ways<-sapply(p, fuction(q)(2*q)^L*((1-q)*2)^W)
ways<-sapply(p, fuction(q)((2*q)^L*((1-q)*2)^W)
prob<- ways/sum(ways)
prob<- ways/sum(ways)
ways<-sapply(p, fuction(q)((2*q)^L*((1-q)*2)^W)
prob<- ways/sum(ways)
w<-sum(sample=="W")
l<-sum(sample=="L")
p<-(0, 0.3, 0.5)
p<-(0,0.3,0.5)
p<-c(0,0.3,0.5)
ways<-sapply(p, fuction(q)((2*q)^L*((1-q)*2)^W)
prob<- ways/sum(ways)
prob<- ways/sum(ways)
ways<-sapply(p, fuction(q)((2*q)^L*((1-q)*2)^W)
ways<-sapply(p, (2*q))
ways<-c(0,9)
prob<- ways/sum(ways)
cbind(p,ways,prob)
sample<-c("L","L")
w<-sum(sample=="W")
l<-sum(sample=="L")
p<-c(0,0.3,0.5)
ways<-c(0,9)
prob<- ways/sum(ways)
cbind(p,ways,prob)
#Chapter 5: Multivariate linear models
# load data
library(rethinking)
data(WaffleDivorce)
d <- WaffleDivorce
# standardize predictor
d$MedianAgeMarriage.s <- (d$MedianAgeMarriage-mean(d$MedianAgeMarriage))/
sd(d$MedianAgeMarriage)
# fit model
m5.1 <- map(
alist(
Divorce ~ dnorm( mu , sigma ) ,
mu <- a + bA * MedianAgeMarriage.s ,
a ~ dnorm( 10 , 10 ) ,
bA ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) , data = d )
d$MedianAgeMarriage.s
# compute percentile interval of mean
MAM.seq <- seq( from=-3 , to=3.5 , length.out=30 )
mu <- link( m5.1 , data=data.frame(MedianAgeMarriage.s=MAM.seq) )
mu.PI <- apply( mu , 2 , PI )
# plot it all
plot( Divorce ~ MedianAgeMarriage.s , data=d , col=rangi2 )
abline( m5.1 )
shade( mu.PI , MAM.seq )
#Chapter 5: Multivariate linear models
# load data
library(rethinking)
data(WaffleDivorce)
d <- WaffleDivorce
# standardize predictor
d$MedianAgeMarriage.s <- (d$MedianAgeMarriage-mean(d$MedianAgeMarriage))/
sd(d$MedianAgeMarriage)
# fit model
m5.1 <- map(
alist(
Divorce ~ dnorm( mu , sigma ) ,
mu <- a + bA * MedianAgeMarriage.s ,
a ~ dnorm( 10 , 10 ) ,
bA ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) , data = d )
m5.1
# compute percentile interval of mean
MAM.seq <- seq( from=-3 , to=3.5 , length.out=30 )
mu <- link( m5.1 , data=data.frame(MedianAgeMarriage.s=MAM.seq) )
mu.PI <- apply( mu , 2 , PI )
# plot it all
plot( Divorce ~ MedianAgeMarriage.s , data=d , col=rangi2 )
abline( m5.1 )
shade( mu.PI , MAM.seq )
precis(m5.1)
d$Marriage.s <- (d$Marriage - mean(d$Marriage))/sd(d$Marriage)
m5.2 <- map(
alist(
Divorce ~ dnorm( mu , sigma ) ,
mu <- a + bR * Marriage.s ,
a ~ dnorm( 10 , 10 ) ,
bR ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) , data = d )
precis(m5.2)
m5.2
#First example of multivariate model
m5.3 <- map( 5.4
alist(
#First example of multivariate model
m5.3 <- map(
alist(
Divorce ~ dnorm( mu , sigma ) ,
mu <- a + bR*Marriage.s + bA*MedianAgeMarriage.s ,
a ~ dnorm( 10 , 10 ) ,
bR ~ dnorm( 0 , 1 ) ,
bA ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) ,
data = d )
precis( m5.3
precis( m5.3 )
plot( precis(m5.3) )
# load data
library(rethinking)
data(milk)
milk<-data(milk)
str(milk)
data(milk)
d<-milk
str(d)
d
dcc <- d[ complete.cases(d) , ]
m5.5 <- map(
alist(
kcal.per.g ~ dnorm( mu , sigma ) ,
mu <- a + bn*neocortex.perc ,
a ~ dnorm( 0 , 100 ) ,
bn ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 1 )
) ,
data=dcc )
precis( m5.5 , digits=3 )
np.seq <- 0:100 5.23
np.seq <- 0:100
pred.data <- data.frame( neocortex.perc=np.seq )
mu <- link( m5.5 , data=pred.data , n=1e4 )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
plot( kcal.per.g ~ neocortex.perc , data=dcc , col=rangi2 )
lines( np.seq , mu.mean )
lines( np.seq , mu.PI[1,] , lty=2 )
lines( np.seq , mu.PI[2,] , lty=2 )
dcc$log.mass <- log(dcc$mass)
m5.6 <- map(
alist(
kcal.per.g ~ dnorm( mu , sigma ) ,
mu <- a + bm*log.mass ,
a ~ dnorm( 0 , 100 ) ,
bm ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 1 )
) ,
data=dcc )
precis(m5.6)
