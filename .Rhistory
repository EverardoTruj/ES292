plot( groupsize ~ weight , data=D )
abline( a=coef(E1.1)["a"] , b=coef(E1.1)["b"]
# display raw data and sample size
plot( D$area , D$groupsize ,
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
N<-10
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:20 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.3)
N<-30
N<-30
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:20 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.3)
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9)
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9)
N<-30
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
post <- extract.samples(E1.1, n=30 )
# display raw data and sample size
N<-30
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
post <- extract.samples(E1.1, n=30 )
# display raw data and sample size
N<-30
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
N<-30
plot( D$area , D$weight ,
xlim=range(D$area) , ylim=range(D$weight) ,
col=rangi2 , xlab="Area" , ylab="weight" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
H2.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 )
sigma ~ dunif( 0 , 10 )
H2.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
precis(H2.1)
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
weight=R.seq,
D$area=A.avg)
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
weight=R.seq, D$area=A.avg)
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
D$weight=R.seq, D$area=A.avg)
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
D$weight=R.seq,
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
D$weight = R.seq,
# prepare new counterfactual data 5.9
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
A.avg <- mean(  D$area )
R.seq <- seq( from=0 , to=7 , length.out=30 )
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
D
A.avg <- mean(  D$area )
R.seq <- seq( from=0 , to=7 , length.out=116 )
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
pre.data <- data.frame(R.seq,A.avg)
mu <- link( H2.1 , data=pred.data )
pred.data <- data.frame(R.seq,A.avg)
mu <- link( H2.1 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
.sim <- sim(H2.1 , data=pred.data , n=1e4
R.PI <- apply( R.sim , 2 , PI )
R.sim <- sim(H2.1 , data=pred.data , n=1e4
R.PI <- apply( R.sim , 2 , PI )
R.sim <- sim(H2.1 , data=pred.data , n=1e4
R.PI <- apply( R.sim , 2 , PI )
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.PI <- apply( R.sim , 2 , PI )
plot( weight ~ D$area , data=D , type="n" )
mtext( "MedianAgeMarriage.s = 0" )
lines( R.seq , mu.mean )
shade( mu.PI , R.seq )
shade( R.PI , R.seq )
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
H2.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
# prepare new counterfactual data
A.avg <- mean(  D$area )
R.seq <- seq( from=0 , to=7 , length.out=116 )
pred.data <- data.frame(R.seq,A.avg)
pred.data <- data.frame(
weight = R.seq,
D$area = A.avg
# compute counterfactual mean weight (mu)
mu <- link( H2.1 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
# simulate counterfactual weight outcomes
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.PI <- apply( R.sim , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$area , data=D , type="n" )
mtext( "MedianAgeMarriage.s = 0" )
lines( R.seq , mu.mean )
shade( mu.PI , R.seq )
shade( R.PI , R.seq )
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(R.seq,A.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.1 , data=pred.data )
#5E2. Write down a multiple regression to evaluate the claim: Animal diversity is linearly related tolatitude, but only after controlling for plant diversity. You just need to write down the model definition
library(rethinking)
AD=(a+BiPDi)+BiLi
d$Marriage.s <- (d$Marriage - mean(d$Marriage))/sd(d$Marriage)
#5E2. Write down a multiple regression to evaluate the claim: Animal diversity is linearly related tolatitude, but only after controlling for plant diversity. You just need to write down the model definition
library(rethinking)
#AD=(a+BiPDi)+BiLi
#5E3. Write down a multiple regression to evaluate the claim: Neither amount of funding nor siz of laboratory is by itself a good predictor of time to PhD degree; but together these variables are both positively associated with time to degree. Write down the model definition and indicate which side of zero each slope parameter should be on.
#T=a+B(F+S)
#5M1. Invent your own example of a spurious correlation. An outcome variable should be correlated with both predictor variables. But when both predictors are entered in the same model, the correlation between the outcome and one of the predictors should mostly vanish (or at least be greatly reduced).
#Lets supose the case of the births of female in a crocodile nest.the gender in the crocodiles is determinated by the temperature at the eggs are incubated. The higher the temperature, the greater the percentage of females there will be. So we can consider the temperature as our real predictor, with a positive slope. At the other hand, There are certain species of grasses that crocodiles usually choose to build their nests, which usually grow in warm climates.
N <- 100 # number of cases
x_real <- rnorm( N ) # x_real as Gaussian with mean 0 and stddev 1
x_spur <- rnorm( N , x_real ) # x_spur as Gaussian with mean=x_real
y <- rnorm( N , x_real ) # y as Gaussian with mean=x_real
d <- data.frame(y,x_real,x_spur) # bind all together in data frame
#5M2. Invent your own example of a masked relationship. An outcome variable should be correlated with both predictor variables, but in opposite directions. And the two predictor variables should be correlated with one another
#Suppose an amphibian population is positively determined by the humidity of its environment, but humidity also positively affects its primary predator populations. The predator population has a negative effect on the amphibian population and the effect of humidity is positive
#Hard. All three exercises below use the same data, data(foxes) (part of rethinking).81 The urban fox (Vulpes vulpes) is a successful exploiter of human habitat. Since urban foxes move in packs and defend territories, data on habitat quality and population density is also included. The data frame has five columns:
#(1) group: Number of the social group the individual fox belongs to
#(2) avgfood: The average amount of food available in the territory
#(3) groupsize: The number of foxes in the social group
#(4) area: Size of the territory
#(5) weight: Body weight of the individual fox
data(foxes)
D<-foxes
str(D)
D
#5H1. Fit two bivariate Gaussian regressions, using map: (1) body weight as a linear function of territory size (area), and (2) body weight as a linear function of groupsize. Plot the results of these regressions, displaying the MAP regression line and the 95% interval of the mean. Is either variable important for predicting fox body weight?
# standardize predictor
D$area <- (D$area-mean(D$area))/sd(D$area)
# fit models
E1.1 <- map(
alist(
groupsize ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area ,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) , data = D )
E1.2 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area ,
a ~ dnorm( 4 , 1 ) ,
bA ~ dnorm( 0 , 1 ) ,
sigma ~ dunif( 0 , 10 )
) , data = D )
precis( E1.1 , corr=TRUE )
precis( E1.2 , corr=TRUE )
post <- extract.samples(E1.1, n=30 )
# display raw data and sample size
N<-30
plot( D$area , D$groupsize ,
xlim=range(D$area) , ylim=range(D$groupsize) ,
col=rangi2 , xlab="Area" , ylab="Group size" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
N<-30
plot( D$area , D$weight ,
xlim=range(D$area) , ylim=range(D$weight) ,
col=rangi2 , xlab="Area" , ylab="weight" )
mtext(concat("N = ",N))
# plot the lines, with transparency
for ( i in 1:30 )
abline( a=post$a[i] , b=post$b[i] , col=col.alpha("black",0.9))
#5H2. Now fit a multiple linear regression with weight as the outcome and both area and groupsize as predictor variables. Plot the predictions of the model for each predictor, holding the other predictor constant at its mean. What does this model say about the importance of each variable? Why do you get different results than you got in the exercise just above?
H2.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
precis(H2.1)
# prepare new counterfactual data
A.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(R.seq,A.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.1 , data=pred.data )
# compute counterfactual mean weight (mu)
mu <- link( H2.1 , data=pred.data )
H2.2 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
pred.data <- data.frame(R.seq,w.avg)
# prepare new counterfactual data
W.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(R.seq,w.avg)
pred.data <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.1 , data=pred.data )
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
R.seq <- seq( from=-3 , to=3 , length.out=10 )
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
W.avg <- mean(  D$area )
R.seq <- seq( from=-3 , to=3 , length.out=10 )
pred.data <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
pred.data
R.seq <- seq( from=-3 , to=3 , length.out=30 )
pred.data <- data.frame(R.seq,W.avg)
pred.data
H2.2
D
R.seq <- seq( from=-3 , to=3 , length.out=116 )
pred.data <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.PI <- apply( R.sim , 2 , PI )
R.PI <- apply( R.sim , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$area , data=D , type="n" )
W.avg <- mean(  D$area )
R.seq <- seq( from=-20 , to=20 , length.out=116 )
pred.data <- data.frame(R.seq,W.avg)
pred.data
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
# simulate counterfactual weight outcomes
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.PI <- apply( R.sim , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$area , data=D , type="n" )
mtext( "MedianAgeMarriage.s = 0" )
lines( R.seq , mu.mean )
shade( mu.PI , R.seq )
shade( R.PI , R.seq )
H2.2 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
# prepare new counterfactual data
W.avg <- mean(  D$area )
R.seq <- seq( from=-20 , to=20 , length.out=116 )
pred.data <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu <- link( H2.2 , data=pred.data )
mu.mean <- apply( mu , 2 , mean )
mu.PI <- apply( mu , 2 , PI )
# simulate counterfactual weight outcomes
R.sim <- sim(H2.1 , data=pred.data , n=1e4)
R.PI <- apply( R.sim , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$area , data=D , type="n" )
mtext( "MedianAgeMarriage.s = 0" )
lines( R.seq , mu.mean )
shade( mu.PI , R.seq )
shade( R.PI , R.seq )
# prepare new counterfactual data
W.avg2 <- mean(  D$groupsize )
R.seq2 <- seq( from=-20 , to=20 , length.out=116 )
pred.data2 <- data.frame(R.seq2,W.avg2)
# compute counterfactual mean weight (mu)
mu2 <- link( H2.2 , data=pred.data2 )
mu.mean2 <- apply( mu2 , 2 , mean )
mu.PI2 <- apply( mu2 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim2 <- sim(H2.1 , data=pred.data2 , n=1e4)
R.PI2 <- apply( R.sim2 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$groupsize , data=D , type="n" )
mtext( "MedianAgeMarriage.s = 0" )
lines( R.seq2 , mu.mean2 )
shade( mu.PI2 , R.seq2 )
shade( R.PI2 , R.seq2 )
H3.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a +bR*D$groupsize+bZ*D$avgfood,
a ~ dnorm( 4 , 1) ,
bR ~ dnorm( 0 , 1 ),
bZ ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
H3.2 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a + bA * D$area +bR*D$groupsize+bZ*D$avgfood,
a ~ dnorm( 4 , 1) ,
bA ~ dnorm( 0 , 1 ),
bR ~ dnorm( 0 , 1 ),
bZ ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
W.avg3.1 <- mean(  D$avgfood )
R.seq3.1 <- seq( from=-20 , to=20 , length.out=116 )
pred.data3.1 <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$groupsize , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
W.avg3.1 <- mean(  D$avgfood )
R.seq3.1 <- seq( from=-10 , to=10 , length.out=116 )
pred.data3.1 <- data.frame(R.seq,W.avg)
# compute counterfactual mean weight (mu)
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$groupsize , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$avgfood , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
W.avg3.1 <- mean(  D$avgfood )
R.seq3.1 <- seq( from=-20 , to=20 , length.out=116 )
pred.data3.1 <- data.frame(R.seq3.1,W.avg3.1)
# compute counterfactual mean weight (mu)
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$avgfood , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
H3.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a +bR*D$groupsize+bZ*D$avgfood,
a ~ dnorm( 4 , 1) ,
bR ~ dnorm( 0 , 1 ),
bZ ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$avgfood , data=D , type="n" )
plot( weight ~ D$avgfood , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot(  D$avgfood ~ weight , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
H3.1 <- map(
alist(
weight ~ dnorm( mu , sigma ) ,
mu <- a +bR*D$groupsize+bZ*D$avgfood,
a ~ dnorm( 4 , 1) ,
bR ~ dnorm( 0 , 1 ),
bZ ~ dnorm( 0 , 1 ),
sigma ~ dunif( 0 , 10 )
) , data = D )
W.avg3.1 <- mean(  D$avgfood )
R.seq3.1 <- seq( from=-20 , to=20 , length.out=116 )
pred.data3.1 <- data.frame(R.seq3.1,W.avg3.1)
# compute counterfactual mean weight (mu)
mu3.1 <- link( H3.1 , data=pred.data3.1 )
mu.mean3.1 <- apply( mu3.1 , 2 , mean )
mu.PI3.1 <- apply( mu3.1 , 2 , PI )
# simulate counterfactual weight outcomes
R.sim3.1 <- sim(H3.1 , data=pred.data3.1 , n=1e4)
R.PI3.1 <- apply( R.sim3.1 , 2 , PI )
# display predictions, hiding raw data with type="n"
plot( weight ~ D$avgfood , data=D , type="n" )
mtext( "Median group size" )
lines( R.seq3.1 , mu.mean3.1 )
shade( mu.PI3.1 , R.seq3.1 )
shade( R.PI3.1 , R.seq3.1 )
precis(H3.1)
